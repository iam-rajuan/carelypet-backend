openapi: 3.0.3
info:
  title: PetConnect API
  version: 1.0.0
servers:
  - url: /api/v1
tags:
  - name: AdminAuth
  - name: AdminProfile
  - name: AdminPets
  - name: AdminUsers
  - name: UserBookings
  - name: UserServices
  - name: UserPayments
  - name: Webhooks
  - name: AdminServiceSettings
  - name: AdminServiceManagement
  - name: UserAuth
  - name: UserProfiles
  - name: UserUploads
components:
  securitySchemes:
    AccessToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Access token returned after login or profile completion.
    SetupToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Setup token returned after OTP verification for onboarding.
  schemas:
    RegisterInput:
      type: object
      required: [name, email, password]
      properties:
        name:
          type: string
          example: Jane Doe
        email:
          type: string
          format: email
          example: jane@example.com
        password:
          type: string
          format: password
          example: Secret123
        phone:
          type: string
          example: "9876543210"
    VerifyEmailInput:
      type: object
      required: [email, otp]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        otp:
          type: string
          example: "123456"
    ResendEmailOtpInput:
      type: object
      required: [email]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
    LoginInput:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        password:
          type: string
          format: password
          example: Secret123
    RefreshTokenInput:
      type: object
      required: [refreshToken]
      properties:
        refreshToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    ForgotPasswordInput:
      type: object
      required: [email]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
    ResetPasswordInput:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        password:
          type: string
          format: password
          example: NewSecret123
    VerifyResetPasswordOtpInput:
      type: object
      required: [email, otp]
      properties:
        email:
          type: string
          format: email
          example: jane@example.com
        otp:
          type: string
          example: "1234"
    CompleteProfileInput:
      type: object
      required: [username, country, avatarUrl]
      properties:
        username:
          type: string
          example: jane_doe
        country:
          type: string
          example: IN
        avatarUrl:
          type: string
          format: uri
          example: https://your-bucket.s3.amazonaws.com/users/avatars/abc.jpg
        favorites:
          type: array
          items:
            type: string
          example: ["dogs", "cats"]
    Location:
      type: object
      properties:
        city:
          type: string
          example: ""
        country:
          type: string
          example: IN
    User:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Jane Doe
        email:
          type: string
          format: email
          example: jane@example.com
        phone:
          type: string
          example: "9876543210"
        role:
          type: string
          example: user
        status:
          type: string
          enum: [active, deletion_request]
        username:
          type: string
          example: jane_doe
        avatarUrl:
          type: string
          format: uri
        location:
          $ref: "#/components/schemas/Location"
        favorites:
          type: array
          items:
            type: string
        isVerified:
          type: boolean
          example: true
        profileCompleted:
          type: boolean
          example: true
        deletionRequestedAt:
          type: string
          format: date-time
          nullable: true
    AdminUserSummary:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Jane Doe
        username:
          type: string
          example: jane_doe
        email:
          type: string
          format: email
          example: jane@example.com
        status:
          type: string
          enum: [active, deletion_request]
        deletionRequestedAt:
          type: string
          format: date-time
          nullable: true
        daysLeft:
          type: integer
          minimum: 0
          nullable: true
        createdAt:
          type: string
          format: date-time
    AdminUserDetails:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Jane Doe
        username:
          type: string
          example: jane_doe
        email:
          type: string
          format: email
          example: jane@example.com
        phone:
          type: string
          example: "9876543210"
        status:
          type: string
          enum: [active, deletion_request]
        deletionRequestedAt:
          type: string
          format: date-time
          nullable: true
        daysLeft:
          type: integer
          minimum: 0
          nullable: true
        isVerified:
          type: boolean
          example: true
        isPhoneVerified:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    ServiceRequestSummary:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        customerName:
          type: string
          example: Jane Doe
        serviceType:
          type: string
          example: grooming
        petType:
          type: string
          example: dog
        petBreed:
          type: string
          example: Labrador
        petAge:
          type: integer
          nullable: true
          example: 3
        status:
          type: string
          enum: [pending, completed]
        createdAt:
          type: string
          format: date-time
    ServiceRequestDetails:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        customer:
          type: object
          properties:
            name:
              type: string
              example: Jane Doe
            phone:
              type: string
              example: "9876543210"
        service:
          type: object
          properties:
            serviceName:
              type: string
              example: Full Grooming
            dateTime:
              type: string
              format: date-time
            providerName:
              type: string
              example: Happy Paws Grooming
            status:
              type: string
              enum: [pending, completed]
        pet:
          type: object
          properties:
            name:
              type: string
              example: Buddy
            type:
              type: string
              example: dog
            breed:
              type: string
              example: Labrador
            age:
              type: integer
              nullable: true
              example: 3
        orderSummary:
          type: object
          properties:
            serviceName:
              type: string
              example: Full Grooming
            petName:
              type: string
              example: Buddy
            servicePrice:
              type: number
              example: 45
            items:
              type: array
              items:
                type: object
                properties:
                  serviceName:
                    type: string
                  petName:
                    type: string
                  price:
                    type: number
        payment:
          type: object
          properties:
            subtotal:
              type: number
              example: 45
            taxPercent:
              type: number
              example: 5
            total:
              type: number
              example: 47.25
            status:
              type: string
              enum: [paid, unpaid]
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    DeletionRequestResponse:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        deletionRequestedAt:
          type: string
          format: date-time
    AuthTokens:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
    AdminLoginInput:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: admin@petconnect.com
        password:
          type: string
          format: password
          example: AdminSecret123
    AdminProfile:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Admin Name
        email:
          type: string
          format: email
          example: admin@petconnect.com
    AdminUpdateProfileInput:
      type: object
      properties:
        name:
          type: string
          example: New Admin Name
        email:
          type: string
          format: email
          example: newadmin@petconnect.com
    AdminChangePasswordInput:
      type: object
      required: [currentPassword, newPassword]
      properties:
        currentPassword:
          type: string
          format: password
        newPassword:
          type: string
          format: password
    UpdateServiceStatusInput:
    ServiceCatalog:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Full Grooming
        type:
          type: string
          enum: [vet, grooming, training, walking]
        price:
          type: number
          example: 45
        isActive:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    TaxSettingResponse:
      type: object
      properties:
        percent:
          type: number
          example: 5
    AvailabilitySettingResponse:
      type: object
      properties:
        startTime:
          type: string
          example: "09:00"
        endTime:
          type: string
          example: "17:00"
        slotMinutes:
          type: integer
          example: 30
    BookingItem:
      type: object
      properties:
        serviceName:
          type: string
          example: Full Grooming
        serviceType:
          type: string
          enum: [vet, grooming, training, walking]
        petName:
          type: string
          example: Buddy
        petType:
          type: string
          example: dog
        petBreed:
          type: string
          example: Labrador
        petAge:
          type: integer
          nullable: true
          example: 3
        unitPrice:
          type: number
          example: 45
    ServiceBooking:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        scheduledAt:
          type: string
          format: date-time
        reminderType:
          type: string
          enum: [none, day_before, week_before]
        status:
          type: string
          enum: [pending, completed]
        paymentStatus:
          type: string
          enum: [paid, unpaid]
        subtotal:
          type: number
          example: 90
        taxPercent:
          type: number
          example: 5
        taxAmount:
          type: number
          example: 4.5
        total:
          type: number
          example: 94.5
        currency:
          type: string
          example: usd
        paymentReceiptUrl:
          type: string
          nullable: true
        items:
          type: array
          items:
            $ref: "#/components/schemas/BookingItem"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    BookingCreateInput:
      type: object
      required: [scheduledAt]
      properties:
        serviceIds:
          type: array
          items:
            type: string
        selectAllServices:
          type: boolean
        petIds:
          type: array
          items:
            type: string
        selectAllPets:
          type: boolean
        scheduledAt:
          type: string
          format: date-time
        reminderType:
          type: string
          enum: [none, day_before, week_before]
        providerId:
          type: string
    BookingConfirmResponse:
      type: object
      properties:
        bookingId:
          type: string
        services:
          type: array
          items:
            type: string
        appointmentDateTime:
          type: string
          format: date-time
        organizationName:
          type: string
          example: Carely Pets
        pets:
          type: array
          items:
            type: string
    BookingListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: "#/components/schemas/ServiceBooking"
        pagination:
          type: object
          properties:
            total:
              type: integer
            page:
              type: integer
            limit:
              type: integer
      type: object
      required: [status]
      properties:
        status:
          type: string
          enum: [pending, completed]
    PetType:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        name:
          type: string
          example: Dog
        slug:
          type: string
          example: dog
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    PetBreed:
      type: object
      properties:
        id:
          type: string
          example: 64f1c3e2d2f2b70012a8b0bb
        name:
          type: string
          example: Labrador
        slug:
          type: string
          example: labrador
        petType:
          type: string
          example: 64f1c3e2d2f2b70012a8b0aa
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CreatePetTypeInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Dog
    UpdatePetTypeInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Small Pet
    CreatePetBreedInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Labrador
    UpdatePetBreedInput:
      type: object
      required: [name]
      properties:
        name:
          type: string
          example: Golden Retriever
paths:
  /admin/settings/services:
    get:
      tags: [AdminServiceSettings]
      summary: Get all service settings
      security:
        - AccessToken: []
      responses:
        "200":
          description: Services list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/ServiceCatalog"
        "401":
          description: Unauthorized
    post:
      tags: [AdminServiceSettings]
      summary: Create service setting
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, type, price]
              properties:
                name:
                  type: string
                type:
                  type: string
                  enum: [vet, grooming, training, walking]
                price:
                  type: number
                isActive:
                  type: boolean
      responses:
        "201":
          description: Service created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/ServiceCatalog"
        "400":
          description: Validation failed
  /admin/settings/services/{id}:
    patch:
      tags: [AdminServiceSettings]
      summary: Update service setting
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                price:
                  type: number
                isActive:
                  type: boolean
      responses:
        "200":
          description: Service updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/ServiceCatalog"
        "404":
          description: Service not found
    delete:
      tags: [AdminServiceSettings]
      summary: Delete service setting
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Service deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "404":
          description: Service not found
  /admin/settings/tax:
    get:
      tags: [AdminServiceSettings]
      summary: Get active tax percentage
      security:
        - AccessToken: []
      responses:
        "200":
          description: Active tax
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/TaxSettingResponse"
    post:
      tags: [AdminServiceSettings]
      summary: Set active tax percentage
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [percent]
              properties:
                percent:
                  type: number
      responses:
        "201":
          description: Tax updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/TaxSettingResponse"
        "400":
          description: Validation failed
  /admin/settings/availability:
    get:
      tags: [AdminServiceSettings]
      summary: Get availability settings
      security:
        - AccessToken: []
      responses:
        "200":
          description: Availability settings
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/AvailabilitySettingResponse"
    patch:
      tags: [AdminServiceSettings]
      summary: Update availability settings
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AvailabilitySettingResponse"
      responses:
        "200":
          description: Availability updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/AvailabilitySettingResponse"
        "400":
          description: Validation failed
    patch:
      tags: [AdminServiceSettings]
      summary: Update active tax percentage
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [percent]
              properties:
                percent:
                  type: number
      responses:
        "200":
          description: Tax updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/TaxSettingResponse"
        "400":
          description: Validation failed
  /services:
    get:
      tags: [UserServices]
      summary: Get available services and tax
      security:
        - AccessToken: []
      responses:
        "200":
          description: Available services
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      services:
                        type: array
                        items:
                          $ref: "#/components/schemas/ServiceCatalog"
                      taxPercent:
                        type: number
        "401":
          description: Unauthorized
  /bookings:
    get:
      tags: [UserBookings]
      summary: Get booking history
      security:
        - AccessToken: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [all, pending, completed]
            default: all
        - name: paymentStatus
          in: query
          required: false
          schema:
            type: string
            enum: [all, paid, unpaid]
            default: all
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: Booking history
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/BookingListResponse"
    post:
      tags: [UserBookings]
      summary: Create service booking and payment intent
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BookingCreateInput"
      responses:
        "201":
          description: Booking created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      booking:
                        $ref: "#/components/schemas/ServiceBooking"
                      clientSecret:
                        type: string
        "400":
          description: Validation failed
  /bookings/availability:
    get:
      tags: [UserBookings]
      summary: Get available time slots for a date
      security:
        - AccessToken: []
      parameters:
        - name: date
          in: query
          required: true
          schema:
            type: string
            example: "2025-12-31"
      responses:
        "200":
          description: Available slots
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      date:
                        type: string
                      slots:
                        type: array
                        items:
                          type: string
        "400":
          description: Validation failed
        "401":
          description: Unauthorized
  /payments:
    get:
      tags: [UserPayments]
      summary: Get payment history
      security:
        - AccessToken: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [all, pending, completed]
            default: all
        - name: paymentStatus
          in: query
          required: false
          schema:
            type: string
            enum: [all, paid, unpaid]
            default: paid
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: Payment history
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/BookingListResponse"
  /webhooks/stripe:
    post:
      tags: [Webhooks]
      summary: Stripe webhook (payment_intent.succeeded)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        "200":
          description: Webhook received
        "400":
          description: Invalid webhook signature
        "500":
          description: Webhook not configured
  /bookings/{id}/confirm:
    post:
      tags: [UserBookings]
      summary: Confirm payment for a booking
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Payment confirmed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/BookingConfirmResponse"
        "400":
          description: Payment not completed
        "404":
          description: Booking not found
  /admin/auth/login:
    post:
      tags: [AdminAuth]
      summary: Admin login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminLoginInput"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      tokens:
                        $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Login failed
  /admin/auth/refresh:
    post:
      tags: [AdminAuth]
      summary: Refresh admin tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Tokens refreshed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Refresh failed
  /admin/auth/logout:
    post:
      tags: [AdminAuth]
      summary: Logout admin by revoking refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Logged out
        "400":
          description: Logout failed
  /admin/auth/forgot-password:
    post:
      tags: [AdminAuth]
      summary: Request admin password reset OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordInput"
      responses:
        "200":
          description: OTP sent if email exists
        "400":
          description: Request failed
  /admin/auth/reset-password:
    post:
      tags: [AdminAuth]
      summary: Reset admin password with OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordInput"
      responses:
        "200":
          description: Password reset
        "400":
          description: Reset failed
  /admin/profile:
    get:
      tags: [AdminProfile]
      summary: Get admin profile
      security:
        - AccessToken: []
      responses:
        "200":
          description: Admin profile
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/AdminProfile"
        "401":
          description: Unauthorized
  /admin/profile/password:
    patch:
      tags: [AdminProfile]
      summary: Change admin password
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminChangePasswordInput"
      responses:
        "200":
          description: Password changed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "400":
          description: Change failed
        "401":
          description: Unauthorized
    patch:
      tags: [AdminProfile]
      summary: Update admin profile
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminUpdateProfileInput"
      responses:
        "200":
          description: Profile updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/AdminProfile"
        "400":
          description: Update failed
        "401":
          description: Unauthorized
  /admin/pet-types:
    post:
      tags: [AdminPets]
      summary: Create pet type
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePetTypeInput"
      responses:
        "201":
          description: Pet type created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/PetType"
        "400":
          description: Validation failed
    get:
      tags: [AdminPets]
      summary: Get all pet types
      security:
        - AccessToken: []
      responses:
        "200":
          description: Pet types list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/PetType"
        "401":
          description: Unauthorized
  /admin/pet-types/{id}:
    patch:
      tags: [AdminPets]
      summary: Update pet type
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePetTypeInput"
      responses:
        "200":
          description: Pet type updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/PetType"
        "400":
          description: Validation failed
        "404":
          description: Not found
    delete:
      tags: [AdminPets]
      summary: Delete pet type
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Pet type deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "404":
          description: Not found
  /admin/pet-types/{typeId}/breeds:
    post:
      tags: [AdminPets]
      summary: Create pet breed
      security:
        - AccessToken: []
      parameters:
        - name: typeId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePetBreedInput"
      responses:
        "201":
          description: Pet breed created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/PetBreed"
        "400":
          description: Validation failed
        "404":
          description: Pet type not found
    get:
      tags: [AdminPets]
      summary: Get pet breeds by type
      security:
        - AccessToken: []
      parameters:
        - name: typeId
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Pet breeds list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/PetBreed"
        "404":
          description: Pet type not found
  /admin/pet-breeds/{id}:
    patch:
      tags: [AdminPets]
      summary: Update pet breed
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePetBreedInput"
      responses:
        "200":
          description: Pet breed updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/PetBreed"
        "404":
          description: Pet breed not found
  /admin/users:
    get:
      tags: [AdminUsers]
      summary: Get all pet owners
      security:
        - AccessToken: []
      responses:
        "200":
          description: Users list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/AdminUserSummary"
        "401":
          description: Unauthorized
  /admin/users/export:
    get:
      tags: [AdminUsers]
      summary: Export pet owners as CSV
      security:
        - AccessToken: []
      responses:
        "200":
          description: CSV file
          content:
            text/csv:
              schema:
                type: string
        "401":
          description: Unauthorized
  /admin/services:
    get:
      tags: [AdminServiceManagement]
      summary: Get all service requests
      security:
        - AccessToken: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [all, pending, completed]
            default: all
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        "200":
          description: Service requests list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/ServiceRequestSummary"
                      pagination:
                        type: object
                        properties:
                          total:
                            type: integer
                          page:
                            type: integer
                          limit:
                            type: integer
        "401":
          description: Unauthorized
  /admin/services/{id}:
    get:
      tags: [AdminServiceManagement]
      summary: Get service request details
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Service request details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/ServiceRequestDetails"
        "401":
          description: Unauthorized
        "404":
          description: Service request not found
    delete:
      tags: [AdminServiceManagement]
      summary: Delete service request
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Service request deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "401":
          description: Unauthorized
        "404":
          description: Service request not found
  /admin/services/{id}/status:
    patch:
      tags: [AdminServiceManagement]
      summary: Update service request status
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateServiceStatusInput"
      responses:
        "200":
          description: Service status updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "400":
          description: Validation failed
        "401":
          description: Unauthorized
        "404":
          description: Service request not found
  /admin/users/{id}:
    get:
      tags: [AdminUsers]
      summary: Get pet owner details
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/AdminUserDetails"
        "401":
          description: Unauthorized
        "404":
          description: User not found
    delete:
      tags: [AdminUsers]
      summary: Delete pet owner
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "401":
          description: Unauthorized
        "404":
          description: User not found
  /auth/register:
    post:
      tags: [UserAuth]
      summary: Register a new user and send email OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterInput"
      responses:
        "201":
          description: OTP sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                      phone:
                        type: string
                      name:
                        type: string
        "400":
          description: Registration failed
  /auth/verify-email:
    post:
      tags: [UserAuth]
      summary: Verify email OTP and get setup token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyEmailInput"
      responses:
        "200":
          description: Email verified
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      needsProfileSetup:
                        type: boolean
                      setupToken:
                        type: string
        "400":
          description: Verification failed
  /auth/resend-email-otp:
    post:
      tags: [UserAuth]
      summary: Resend email OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResendEmailOtpInput"
      responses:
        "200":
          description: OTP resent
        "400":
          description: Resend failed
  /auth/login:
    post:
      tags: [UserAuth]
      summary: Login with email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginInput"
      responses:
        "200":
          description: Login success or profile setup required
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      tokens:
                        $ref: "#/components/schemas/AuthTokens"
                      needsProfileSetup:
                        type: boolean
                      setupToken:
                        type: string
        "400":
          description: Login failed
  /auth/complete-profile:
    post:
      tags: [UserAuth]
      summary: Complete onboarding and receive tokens
      security:
        - SetupToken: []
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompleteProfileInput"
      responses:
        "200":
          description: Profile completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      user:
                        $ref: "#/components/schemas/User"
                      tokens:
                        $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Profile setup failed
        "401":
          description: Unauthorized
  /auth/refresh:
    post:
      tags: [UserAuth]
      summary: Refresh access and refresh tokens
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Tokens refreshed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/AuthTokens"
        "400":
          description: Refresh failed
  /auth/logout:
    post:
      tags: [UserAuth]
      summary: Logout by revoking refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenInput"
      responses:
        "200":
          description: Logged out
        "400":
          description: Logout failed
  /auth/forgot-password:
    post:
      tags: [UserAuth]
      summary: Request password reset OTP
      description: "Step 1/3: Request OTP by email. POST /api/user/auth/forgot-password {\"email\":\"user@example.com\"}"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordInput"
            example:
              email: user@example.com
      responses:
        "200":
          description: OTP sent if email exists
          content:
            application/json:
              example:
                success: true
                message: If this email exists, an OTP has been sent
        "400":
          description: Request failed
  /auth/verify-reset-otp:
    post:
      tags: [UserAuth]
      summary: Verify password reset OTP
      description: "Step 2/3: Verify OTP. POST /api/user/auth/verify-reset-otp {\"email\":\"user@example.com\",\"otp\":\"1234\"}"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyResetPasswordOtpInput"
            example:
              email: user@example.com
              otp: "1234"
      responses:
        "200":
          description: OTP verified
          content:
            application/json:
              example:
                success: true
                message: OTP verified
        "400":
          description: OTP verification failed
  /auth/reset-password:
    post:
      tags: [UserAuth]
      summary: Reset password after OTP verification
      description: "Step 3/3: Change password (no OTP here). POST /api/user/auth/reset-password {\"email\":\"user@example.com\",\"password\":\"newPassword123\"}"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordInput"
            example:
              email: user@example.com
              password: newPassword123
      responses:
        "200":
          description: Password reset
          content:
            application/json:
              example:
                success: true
                message: Password reset successful
        "400":
          description: Reset failed
  /uploads/user/avatar:
    post:
      tags: [UserUploads]
      summary: Upload user avatar (accepts setup or access token)
      security:
        - SetupToken: []
        - AccessToken: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "201":
          description: Avatar uploaded
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      avatarUrl:
                        type: string
                        format: uri
                      url:
                        type: string
                        format: uri
                      key:
                        type: string
        "400":
          description: Upload failed
        "401":
          description: Unauthorized
  /users/me:
    get:
      tags: [UserProfiles]
      summary: Get own profile
      security:
        - AccessToken: []
      responses:
        "200":
          description: Profile
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized
    patch:
      tags: [UserProfiles]
      summary: Update own profile
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                bio:
                  type: string
                phone:
                  type: string
                address:
                  type: string
                city:
                  type: string
                country:
                  type: string
                favorites:
                  type: array
                  items:
                    type: string
                location:
                  $ref: "#/components/schemas/Location"
      responses:
        "200":
          description: Profile updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/User"
        "400":
          description: Update failed
        "401":
          description: Unauthorized
  /users/me/password:
    patch:
      tags: [UserProfiles]
      summary: Change own password
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [currentPassword, newPassword]
              properties:
                currentPassword:
                  type: string
                  format: password
                newPassword:
                  type: string
                  format: password
      responses:
        "200":
          description: Password changed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        "400":
          description: Change failed
        "401":
          description: Unauthorized
  /users/me/avatar:
    patch:
      tags: [UserProfiles]
      summary: Update own avatar URL
      security:
        - AccessToken: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [avatarUrl]
              properties:
                avatarUrl:
                  type: string
                  format: uri
      responses:
        "200":
          description: Avatar updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/User"
        "400":
          description: Update failed
        "401":
          description: Unauthorized
  /users/me/delete-request:
    post:
      tags: [UserProfiles]
      summary: Request account deletion
      security:
        - AccessToken: []
      responses:
        "200":
          description: Deletion request received
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/DeletionRequestResponse"
        "400":
          description: Request failed
        "401":
          description: Unauthorized
  /users/me/delete-request/withdraw:
    post:
      tags: [UserProfiles]
      summary: Withdraw account deletion request
      security:
        - AccessToken: []
      responses:
        "200":
          description: Deletion request withdrawn
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    $ref: "#/components/schemas/DeletionRequestResponse"
        "400":
          description: Withdraw failed
        "401":
          description: Unauthorized
  /users/{id}:
    get:
      tags: [UserProfiles]
      summary: Get user by id
      security:
        - AccessToken: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized
        "404":
          description: User not found
